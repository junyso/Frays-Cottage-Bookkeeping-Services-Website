<?php
/**
 * FA DATABASE CREDENTIALS - Per-instance database access
 * 
 * This file contains database credentials for each FA instance.
 * CRITICAL: Keep this file secure! Do NOT commit to public repositories.
 */

// FA Instances Database Configuration
// Each instance has its own database with unique credentials
$FA_DATABASES = [
    'northernwarehouse' => [
        'database' => 'bookkeepingco_fron93',
        'username' => 'bookkeepingco_fron93',
        'password' => '5]9fmNS4(p',
        'host' => 'localhost'
    ],
    'madamz' => [
        'database' => 'bookkeepingco_fron75',
        'username' => 'bookkeepingco_fron75',
        'password' => 'p5!.09TS03',
        'host' => 'localhost'
    ],
    'cleaningguru' => [
        'database' => 'bookkeepingco_fron35',
        'username' => 'bookkeepingco_fron35',
        'password' => 'S3124![png',
        'host' => 'localhost'
    ],
    'quanto' => [
        'database' => 'bookkeepingco_fron61',
        'username' => 'bookkeepingco_fron61',
        'password' => 'S6m]69h@pJ',
        'host' => 'localhost'
    ],
    'spaceinteriors' => [
        'database' => 'bookkeepingco_fron89',
        'username' => 'bookkeepingco_fron89',
        'password' => '502Si(qp5]',
        'host' => 'localhost'
    ],
    'unlimitedfoods' => [
        'database' => 'bookkeepingco_fron71',
        'username' => 'bookkeepingco_fron71',
        'password' => '27SoQr@p4(',
        'host' => 'localhost'
    ],
    'ernletprojects' => [
        'database' => 'bookkeepingco_fron88',
        'username' => 'bookkeepingco_fron88',
        'password' => '1(3@0p094S',
        'host' => 'localhost'
    ],
    'frayscottage' => [
        'database' => 'bookkeepingco_fron00',
        'username' => 'bookkeepingco_fron00',
        'password' => '8pS@h41!17',
        'host' => 'localhost'
    ],
    'constantadaptation' => [
        'database' => 'bookkeepingco_fron53',
        'username' => 'bookkeepingco_fron53',
        'password' => 'Ip72[DS@1e',
        'host' => 'localhost'
    ],
    'great-land' => [
        'database' => 'bookkeepingco_fron24',
        'username' => 'bookkeepingco_fron24',
        'password' => '59tpaS3.6)',
        'host' => 'localhost'
    ],
    'lighteningstrike' => [
        'database' => 'bookkeepingco_fron70',
        'username' => 'bookkeepingco_fron70',
        'password' => 'p5bPS(5!M9',
        'host' => 'localhost'
    ],
    'notsa' => [
        'database' => 'bookkeepingco_fron60',
        'username' => 'bookkeepingco_fron60',
        'password' => '3Z8r9pSq])',
        'host' => 'localhost'
    ],
    'thaega' => [
        'database' => 'bookkeepingco_fron65',
        'username' => 'bookkeepingco_fron65',
        'password' => 'S9)Dp5[sJ6',
        'host' => 'localhost'
    ],
    'modernhotelsupplies' => [
        'database' => 'bookkeepingco_fron21',
        'username' => 'bookkeepingco_fron21',
        'password' => '0Q8S@4p7-2',
        'host' => 'localhost'
    ],
    'training' => [
        'database' => 'bookkeepingco_fron94',
        'username' => 'bookkeepingco_fron94',
        'password' => '9S9BpA-O0!',
        'host' => 'localhost'
    ],
    'majande' => [
        'database' => 'bookkeepingco_fron84',
        'username' => 'bookkeepingco_fron84',
        'password' => '7AD(S8Jp6!',
        'host' => 'localhost'
    ],
    'guruonks' => [
        'database' => 'bookkeepingco_00onks',
        'username' => 'bookkeepingco_00onks',
        'password' => 'p29[USKQ-4',
        'host' => 'localhost'
    ],
    'marctizmo' => [
        'database' => 'bookkeepingco_fron40',
        'username' => 'bookkeepingco_fron40',
        'password' => 'S7-]Y8p4o1',
        'host' => 'localhost'
    ],
    '4bnb' => [
        'database' => 'bookkeepingco_fron17',
        'username' => 'bookkeepingco_fron17',
        'password' => '6h.p990S]9',
        'host' => 'localhost'
    ],
    'noracosmetics' => [
        'database' => 'bookkeepingco_fron43',
        'username' => 'bookkeepingco_fron43',
        'password' => 'p64Su3-5F.',
        'host' => 'localhost'
    ],
    '3dworks' => [
        'database' => 'bookkeepingco_fron48',
        'username' => 'bookkeepingco_fron48',
        'password' => 'e24)(pfbS8',
        'host' => 'localhost'
    ],
    'westdrayton' => [
        'database' => 'bookkeepingco_01',
        'username' => 'bookkeepingco_01',
        'password' => ')pS920NSr.',
        'host' => 'localhost'
    ],
    'ernletprojects2' => [
        'database' => 'bookkeepingco_fron621',
        'username' => 'bookkeepingco_fron621',
        'password' => 'pXi.43S20@',
        'host' => 'localhost'
    ],
    'ernletgroup' => [
        'database' => 'bookkeepingco_fron114',
        'username' => 'bookkeepingco_fron114',
        'password' => 'Mp56US]Z[9',
        'host' => 'localhost'
    ],
    'couriersolutions' => [
        'database' => 'bookkeepingco_fron895',
        'username' => 'bookkeepingco_fron895',
        'password' => '].pA235AdS',
        'host' => 'localhost'
    ],
    'loremaster' => [
        'database' => 'bookkeepingco_fron558',
        'username' => 'bookkeepingco_fron558',
        'password' => ']qS29p9x8]',
        'host' => 'localhost'
    ],
    'coverlot' => [
        'database' => 'bookkeepingco_fron997',
        'username' => 'bookkeepingco_fron997',
        'password' => '2mS-22[3pq',
        'host' => 'localhost'
    ],
    'globalstrategies' => [
        'database' => 'bookkeepingco_fron143',
        'username' => 'bookkeepingco_fron143',
        'password' => '6Slc!p5@56',
        'host' => 'localhost'
    ],
    'norahbeauty' => [
        'database' => 'bookkeepingco_fron773',
        'username' => 'bookkeepingco_fron773',
        'password' => 'oB.9pS32p(',
        'host' => 'localhost'
    ],
    'nidarshini' => [
        'database' => 'bookkeepingco_fron341',
        'username' => 'bookkeepingco_fron341',
        'password' => 'w93p6A(S9',
        'host' => 'localhost'
    ]
];

/**
 * Get database connection for a specific FA instance
 */
function getFAConnection($instanceKey) {
    global $FA_DATABASES;
    
    if (!isset($FA_DATABASES[$instanceKey])) {
        throw new Exception("Database credentials not found for instance: {$instanceKey}");
    }
    
    $config = $FA_DATABASES[$instanceKey];
    
    try {
        $dsn = "mysql:host={$config['host']};dbname={$config['database']};charset=utf8mb4";
        $pdo = new PDO($dsn, $config['username'], $config['password'], [
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
            PDO::ATTR_EMULATE_PREPARES => false
        ]);
        return $pdo;
    } catch (PDOException $e) {
        error_log("FA Database connection failed ({$instanceKey}): " . $e->getMessage());
        return null;
    }
}

/**
 * Test connection to all FA instances
 */
function testFAConnections() {
    global $FA_DATABASES;
    $results = [];
    
    foreach ($FA_DATABASES as $key => $config) {
        try {
            $start = microtime(true);
            $pdo = getFAConnection($key);
            $time = round((microtime(true) - $start) * 1000, 2);
            
            if ($pdo) {
                $results[$key] = [
                    'status' => 'connected',
                    'ms' => $time,
                    'database' => $config['database']
                ];
            } else {
                $results[$key] = [
                    'status' => 'failed',
                    'error' => 'Connection returned null'
                ];
            }
        } catch (Exception $e) {
            $results[$key] = [
                'status' => 'error',
                'error' => $e->getMessage()
            ];
        }
    }
    
    return $results;
}
